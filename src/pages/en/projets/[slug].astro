---
/**
 * Page projet individuelle — Editorial Luxe (EN)
 * Route dynamique : /projets/[slug]
 */
import Layout from '@layouts/Layout.astro';
import Section from '@components/ui/Section.astro';
import Container from '@components/ui/Container.astro';
import Button from '@components/ui/Button.astro';
import { projects } from '../../../data/projects';
import type { Project } from '../../../data/projects';
import { t, getLocalizedPath } from '@i18n/index';
import type { Locale } from '@i18n/languages';

const lang: Locale = 'en';
const d = 'projetDetail' as const;

export function getStaticPaths() {
  return projects.map((project) => ({
    params: { slug: project.slug },
    props: { project },
  }));
}

interface Props {
  project: Project;
}

const { project } = Astro.props;

const categoryLabels: Record<string, string> = {
  appartement: t(d, 'catAppartement', lang),
  residence: t(d, 'catResidence', lang),
  maison: t(d, 'catMaison', lang),
  'salle-de-bains': t(d, 'catSalleDeBains', lang),
};

const styleLabels: Record<string, string> = {
  moderne: t(d, 'styleModerne', lang),
  classique: t(d, 'styleClassique', lang),
  contemporain: t(d, 'styleContemporain', lang),
};

const related = [
  ...projects.filter((p) => p.id !== project.id && p.category === project.category),
  ...projects.filter((p) => p.id !== project.id && p.category !== project.category),
].slice(0, 3);
---

<Layout
  lang={lang}
  title={`${project.title} — ${categoryLabels[project.category]} ${project.location} | SB Design Riviera`}
  description={project.description}
>

  <!-- Header éditorial style antoniolupi -->
  <section class="pt-28 md:pt-36 pb-4 md:pb-6 px-6 md:px-10 lg:px-14">
    <a
      href={getLocalizedPath('/projets', lang)}
      class="inline-flex items-center text-primary-dark/30 hover:text-primary-dark transition-colors duration-300 mb-6 md:mb-10"
    >
      <svg class="w-5 h-5" fill="none" stroke="currentColor" stroke-width="1.5" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" d="M19 12H5m0 0l7-7m-7 7l7 7" />
      </svg>
    </a>

    <nav class="editorial-breadcrumb flex flex-wrap items-baseline gap-x-1 md:gap-x-2">
      <span class="editorial-nav-item font-display text-[clamp(24px,4vw,48px)] font-bold italic uppercase text-primary-dark/10 leading-none cursor-default select-none">
        SB
      </span>
      <a
        href={getLocalizedPath('/projets', lang)}
        class="editorial-nav-item font-display text-[clamp(24px,4vw,48px)] font-bold uppercase text-primary-dark leading-none"
      >
        /{t('nav', 'projets', lang)}
      </a>
      <span class="editorial-nav-item font-display text-[clamp(24px,4vw,48px)] font-bold uppercase text-primary-dark leading-none cursor-default">
        /{categoryLabels[project.category]}
      </span>
      <span class="editorial-nav-item font-display text-[clamp(40px,8vw,110px)] font-light uppercase text-primary-dark/10 leading-[1.1] cursor-default select-none">
        {project.title}
      </span>
    </nav>
  </section>

  <!-- Cover image full-bleed -->
  <div class="w-full h-[55vh] min-h-[350px] lg:h-[70vh] overflow-hidden">
    <img src={project.coverImage} alt={project.title} class="w-full h-full object-cover" loading="eager" />
  </div>

  <!-- Détails -->
  <Section padding="lg" background="white">
    <Container>
      <div class="grid grid-cols-1 lg:grid-cols-[280px_1fr] gap-12 lg:gap-20" data-reveal>
        <div class="space-y-6">
          <div>
            <span class="font-heading text-xs font-semibold uppercase tracking-[0.15em] text-[var(--color-text-light)]">{t(d, 'labelLieu', lang)}</span>
            <p class="font-body text-lg font-light text-primary-dark mt-1">{project.location}</p>
          </div>
          <div class="w-full h-px bg-border" />
          <div>
            <span class="font-heading text-xs font-semibold uppercase tracking-[0.15em] text-[var(--color-text-light)]">{t(d, 'labelSurface', lang)}</span>
            <p class="font-body text-lg font-light text-primary-dark mt-1">{project.surface} m&sup2;</p>
          </div>
          <div class="w-full h-px bg-border" />
          <div>
            <span class="font-heading text-xs font-semibold uppercase tracking-[0.15em] text-[var(--color-text-light)]">{t(d, 'labelAnnee', lang)}</span>
            <p class="font-body text-lg font-light text-primary-dark mt-1">{project.year}</p>
          </div>
          <div class="w-full h-px bg-border" />
          <div>
            <span class="font-heading text-xs font-semibold uppercase tracking-[0.15em] text-[var(--color-text-light)]">{t(d, 'labelStyle', lang)}</span>
            <p class="font-body text-lg font-light text-primary-dark mt-1">{styleLabels[project.style]}</p>
          </div>
          <div class="w-full h-px bg-border" />
          <div>
            <span class="font-heading text-xs font-semibold uppercase tracking-[0.15em] text-[var(--color-text-light)]">{t(d, 'labelCategorie', lang)}</span>
            <p class="font-body text-lg font-light text-primary-dark mt-1">{categoryLabels[project.category]}</p>
          </div>
        </div>
        <div>
          <h2 class="font-display text-subsection font-bold uppercase text-primary-dark mb-8">
            {t(d, 'aboutTitle1', lang)} <span class="font-heading font-light">{t(d, 'aboutTitle2', lang)}</span>
          </h2>
          <p class="font-body text-lg font-light text-[var(--color-text-light)] leading-[1.85] max-w-2xl">
            {project.description}
          </p>
        </div>
      </div>
    </Container>
  </Section>

  <!-- Transition image -->
  {project.images.length > 1 && (
    <div class="w-full h-[40vh] min-h-[280px] lg:h-[50vh] overflow-hidden">
      <img src={project.images[1]} alt="" class="w-full h-full object-cover" loading="lazy" />
    </div>
  )}

  <!-- Design philosophy -->
  <Section padding="lg" background="warm">
    <Container>
      <div class="grid grid-cols-1 lg:grid-cols-[1fr_1fr] gap-12 lg:gap-20" data-reveal>
        <div>
          <div class="w-10 h-px bg-accent-gold/40 mb-6" />
          <h2 class="font-display text-subsection font-bold uppercase text-primary-dark mb-8">
            {t(d, 'philosophyTitle1', lang)} <span class="font-heading font-light">{t(d, 'philosophyTitle2', lang)}</span>
          </h2>
          <p class="font-body text-base font-light text-[var(--color-text-light)] leading-[1.85] italic">
            {project.philosophy}
          </p>
        </div>
        <div>
          <div class="w-10 h-px bg-accent-gold/40 mb-6" />
          <h2 class="font-display text-subsection font-bold uppercase text-primary-dark mb-8">
            {t(d, 'highlightsTitle1', lang)} <span class="font-heading font-light">{t(d, 'highlightsTitle2', lang)}</span>
          </h2>
          <ul class="space-y-4">
            {project.highlights.map((item) => (
              <li class="flex items-start gap-3">
                <svg class="w-4 h-4 text-accent-gold mt-1 shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M5 13l4 4L19 7" />
                </svg>
                <span class="font-body text-sm font-light text-[var(--color-text-light)] leading-relaxed">{item}</span>
              </li>
            ))}
          </ul>
        </div>
      </div>
    </Container>
  </Section>

  <!-- Gallery -->
  {project.images.length > 0 && (
    <Section padding="lg" background="white">
      <Container>
        <div class="mb-12 md:mb-16" data-reveal>
          <h2 class="font-display text-subsection font-bold uppercase text-primary-dark">
            {t(d, 'galleryTitle1', lang)} <span class="font-heading font-light">{t(d, 'galleryTitle2', lang)}</span>
          </h2>
        </div>
        <div
          class:list={[
            "grid gap-3 md:gap-4",
            project.images.length === 1 ? "grid-cols-1" : "grid-cols-1 md:grid-cols-2",
          ]}
          data-reveal
        >
          {project.images.map((img, i) => (
            <div
              class:list={[
                "group overflow-hidden",
                i === 0 && project.images.length > 2 ? "md:col-span-2" : "",
              ]}
            >
              <img
                src={img}
                alt={`${project.title} — Photo ${i + 1}`}
                class:list={[
                  "w-full object-cover transition-transform duration-700 ease-smooth group-hover:scale-[1.05]",
                  i === 0 && project.images.length > 2
                    ? "h-[350px] lg:h-[60vh] lg:min-h-[450px]"
                    : project.images.length === 1
                      ? "h-[400px] lg:h-[70vh] lg:min-h-[500px]"
                      : "h-[300px] lg:h-[50vh] lg:min-h-[400px]",
                ]}
                loading="lazy"
              />
            </div>
          ))}
        </div>
      </Container>
    </Section>
  )}

  <!-- Materials & finishes -->
  <Section padding="lg" background="warm">
    <Container>
      <div data-reveal>
        <div class="w-10 h-px bg-accent-gold/40 mb-6" />
        <h2 class="font-display text-subsection font-bold uppercase text-primary-dark mb-12">
          {t(d, 'materialsTitle1', lang)} <span class="font-heading font-light">{t(d, 'materialsTitle2', lang)}</span>
        </h2>
        <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-6">
          {project.materials.map((material) => (
            <div class="text-center">
              <div class="w-12 h-12 mx-auto mb-3 rounded-full bg-[var(--color-warm)] flex items-center justify-center">
                <div class="w-2 h-2 rounded-full bg-accent-gold/50" />
              </div>
              <span class="font-heading text-[12px] font-medium text-primary-dark uppercase tracking-[0.08em] leading-tight block">{material}</span>
            </div>
          ))}
        </div>
      </div>
    </Container>
  </Section>

  <!-- Other projects -->
  <Section padding="lg" background="white">
    <Container>
      <div class="mb-12 md:mb-16" data-reveal>
        <h2 class="font-display text-subsection font-bold uppercase text-primary-dark">
          {t(d, 'relatedTitle1', lang)} <span class="font-heading font-light">{t(d, 'relatedTitle2', lang)}</span>
        </h2>
      </div>
      <div class="grid grid-cols-1 md:grid-cols-3 gap-3 md:gap-4" data-reveal>
        {related.map((p) => (
          <a href={getLocalizedPath(`/projets/${p.slug}`, lang)} class="group relative overflow-hidden block h-[280px] lg:h-[380px]">
            <img src={p.coverImage} alt={p.title} class="w-full h-full object-cover transition-transform duration-700 ease-smooth group-hover:scale-[1.08]" loading="lazy" />
            <div class="absolute inset-0 bg-gradient-to-t from-black/50 via-transparent to-transparent group-hover:from-black/70 transition-all duration-500" />
            <div class="absolute bottom-0 left-0 right-0 p-5">
              <span class="text-[11px] font-heading font-medium text-accent-gold uppercase tracking-[0.15em]">{categoryLabels[p.category]}</span>
              <h3 class="font-display text-xl font-semibold uppercase text-white mt-1">{p.title}</h3>
            </div>
          </a>
        ))}
      </div>
      <div class="text-center mt-12 md:mt-16">
        <Button href={getLocalizedPath('/projets', lang)} variant="outline" size="lg">
          {t(d, 'viewAll', lang)}
        </Button>
      </div>
    </Container>
  </Section>

  <!-- CTA -->
  <Section background="dark" padding="lg">
    <Container>
      <div class="text-center max-w-2xl mx-auto" data-reveal>
        <h2 class="font-display text-section font-bold uppercase text-white mb-6">
          {t(d, 'ctaTitle1', lang)} <span class="font-heading font-light">{t(d, 'ctaTitle2', lang)}</span>
        </h2>
        <p class="font-body text-lg font-light text-white/70 mb-10 leading-relaxed">
          {t(d, 'ctaDesc', lang)}
        </p>
        <Button href={getLocalizedPath('/contact', lang)} variant="primary" size="lg">
          {t(d, 'ctaBtn', lang)}
        </Button>
      </div>
    </Container>
  </Section>

</Layout>
